# Basic Usage

```{r, include = FALSE, eval=TRUE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = TRUE
)
```

`oepsData` is centered around two functions: `load_oeps_dictionary`, which loads a basic data dictionary; and `load_oeps`, which directly loads OEPS data. We expect that most users will start by calling `load_oeps_dictionary` to look at what data is available at their desired analysis scale, followed by calling `load_oeps` to actually load the data.

`load_oeps_dictionary` itself takes one argument -- scale -- that can be any of "tract", "zcta", "county", or "state". It returns the data dictionary (stored as a data.frame), so we recommend browsing it through the `View` command:

```{r preview data}
# See what data is available at the state level
data_dictionary <- load_oeps_dictionary(scale="state")

# if working in RStudio, we recommend:
# View(data_dictionary)

# as we're in a bookdown, we just preview it simply:
data_dictionary
```

We might find that we're interested in the 1990 state data. We can load that data and its geometries using `load_oeps`.

```{r basic data loading}

states_1990 <- load_oeps(scale="state", 
          year=1990,
          geometry=TRUE)

head(data.frame(states_1990))
```

Which lets us operate on the data as we desire. For instance, we can make a simple map:

```{r}

# reproject to a better, albeit imperfect, display CRS
states_1990 <- sf::st_transform(states_1990, "ESRI:102004")

tm_shape(states_1990) + 
  tm_fill("NoHsP", style="jenks") +
  tm_borders(alpha=0.05) +
  tm_layout(main.title = "Population over 25 without a high school degree")

```


## Cacheing

`oepsData` pulls its data from online repositories, primarily GitHub. This can lead to issues for users operating on slow internet, for whom load times can be long for larger datasets, or for users who anticipate needing the package when entirely offline.

To help minimize these issues, `oepsData` caches, or saves a local copy of, data loaded by `load_oeps` on its first load. Additionally, `oepsData` offers a few commands can help maintain caches:
* `cache_geometries` and `cache_oeps_tables` cache all tables and geometries, overwriting prior ones in the process.
* `clear_cache` deletes all cached data.
* `cache_dir` returns the directory of the oepsData cache.

Users who want to avoid using cached data and instead download data fresh every time can set `cache=FALSE` when calling `load_oeps`. 

